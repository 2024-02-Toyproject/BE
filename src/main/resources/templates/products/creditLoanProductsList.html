<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>테이블 데이터</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }
        .search-container {
            display: flex;
            justify-content: center;
            margin-top: 50px;
            margin-bottom: 50px;
        }
        .search-input {
            width: 300px;
            height: 40px;
            padding: 5px;
        }
        .search-button {
            padding: 16px 20px;
            margin-left: 10px;
        }
        .filter-container {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            height: 30px;
        }
        .filter-container select {
            margin: 0 10px;
        }
    </style>
</head>

<body>
<!-- 검색 창 추가 -->
<div class="search-container">
    <input type="text" id="searchInput" class="search-input" placeholder="검색어를 입력하세요">
    <button onclick="search()" class="search-button">검색</button>
</div>

<div class="filter-container">
    <select id="companySelect" class="company-select" onchange="filterTable()">
        <option value="all">은행</option>
        <option value="국민은행">국민은행</option>
        <option value="경남은행">경남은행</option>
        <option value="광주은행">광주은행</option>
        <option value="농협은행">농협은행</option>
        <option value="대구은행">대구은행</option>
        <option value="부산은행">부산은행</option>
        <option value="신한은행">신한은행</option>
        <option value="수협은행">수협은행</option>
        <option value="우리은행">우리은행</option>
        <option value="중소기업은행">중소기업은행</option>
        <option value="전북은행">전북은행</option>
        <option value="제주은행">제주은행</option>
        <option value="카카오뱅크">카카오뱅크</option>
        <option value="케이뱅크">케이뱅크</option>
        <option value="토스">토스뱅크</option>
        <option value="하나은행">하나은행</option>
        <option value="한국스탠다드차타드은행">한국스탠다드차타드은행</option>
        <option value="한국씨티은행">한국씨티은행</option>
    </select>
    <select id="methodSelect" class="method-select" onchange="filterTable()">
        <option value="all">가입 방법</option>
        <option value="영업점">영업점</option>
        <option value="인터넷">인터넷</option>
        <option value="스마트폰">스마트폰</option>
        <option value="전화">전화(텔레뱅킹)</option>
        <option value="모집인">모집인</option>
        <option value="기타">기타</option>
    </select>
    <select id="loanTypeSelect" class="loanType-select" onchange="filterTable()">
        <option value="all">대출종류</option>
        <option value="일반신용">일반신용</option>
        <option value="마이너스한도">마이너스한도</option>
        <option value="장기카드">장기카드</option>
    </select>
</div>

<table>
    <tr>
        <th>금융회사 명</th>
        <th>금융 상품명</th>
        <th>가입 방법</th>
        <th>대출종류명</th>
        <th>CB 회사명</th>
        <th>금리구분</th>
        <th>평균 금리</th>
        <th>관심 상품 등록</th>
    </tr>

    <tr th:each="creditLoan : ${creditLoans}">
        <td th:text="${creditLoan.company}"></td>
        <td th:text="${creditLoan.productName}"></td>
        <td th:text="${creditLoan.method}"></td>
        <td th:text="${creditLoan.loanType}"></td>
        <td th:text="${creditLoan.cbCompany}"></td>
        <td th:text="${creditLoan.rateType}"></td>
        <td th:text="${creditLoan.averageRate}"></td>
        <td>
            <input type="submit" value="관심목록에 추가">
        </td>
    </tr>

</table>

<script>

    // 필터링 옵션으로 데이터 조회
    function filterTable() {
        var companySelect = document.getElementById("companySelect");
        var methodSelect = document.getElementById("methodSelect");
        var loanTypeSelect = document.getElementById("loanTypeSelect");
        var companyValue = companySelect.value;
        var methodValue = methodSelect.value;
        var loanTypeValue = loanTypeSelect.value;

        var table = document.querySelector("table");
        var rows = table.querySelectorAll("tr");

        for (var i = 1; i < rows.length; i++) {
            var companyCell = rows[i].querySelectorAll("td")[0];
            var methodCell = rows[i].querySelectorAll("td")[2];
            var loanTypeCell = rows[i].querySelectorAll("td")[3];

            if ((companyValue === "all" || companyCell.textContent.includes(companyValue)) &&
                (methodValue === "all" || methodCell.textContent.includes(methodValue)) &&
                (loanTypeValue === "all" || loanTypeCell.textContent.includes(loanTypeValue))) {
                rows[i].style.display = "";
            } else {
                rows[i].style.display = "none";
            }


        }
    }

    // 검색어로 데이터를 조회
    function search() {
        var input = document.getElementById("searchInput").value.toLowerCase();
        var rows = document.getElementsByTagName("tr");

        for (var i = 1; i < rows.length; i++) {
            var cells = rows[i].getElementsByTagName("td");
            var found = false;

            for (var j = 0; j < cells.length; j++) {
                var cellValue = cells[j].textContent || cells[j].innerText;

                if (cellValue.toLowerCase().indexOf(input) > -1) {
                    found = true;
                    break;
                }
            }

            if (found) {
                rows[i].style.display = "";
            } else {
                rows[i].style.display = "none";
            }
        }
    }

</script>

</body>
</html>

